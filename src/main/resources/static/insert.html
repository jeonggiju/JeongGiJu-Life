<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JeongGiJu - ë°ì´í„° ì…ë ¥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 12px;
            padding: 20px 30px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            color: #f5576c;
            font-size: 24px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .user-info {
            color: #666;
            margin-right: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #f5576c;
            color: white;
        }

        .btn-primary:hover {
            background: #e04455;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(245, 87, 108, 0.4);
        }

        .btn-secondary {
            background: #ffe0e6;
            color: #f5576c;
        }

        .btn-secondary:hover {
            background: #ffc9d4;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-success {
            background: #22c55e;
            color: white;
        }

        .btn-success:hover {
            background: #16a34a;
        }

        .login-card {
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            max-width: 400px;
            margin: 100px auto;
        }

        .login-card h2 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #f5576c;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .card h3 {
            color: #333;
            margin-bottom: 25px;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }

        .tab {
            padding: 12px 24px;
            cursor: pointer;
            border: none;
            background: none;
            color: #666;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }

        .tab:hover {
            color: #f5576c;
        }

        .tab.active {
            color: #f5576c;
            border-bottom-color: #f5576c;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .category-select {
            background: #f9fafb;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .category-select label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 600;
        }

        .category-select select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            font-size: 14px;
        }

        .success-message {
            background: #dcfce7;
            color: #166534;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #22c55e;
            display: none;
        }

        .error-message {
            background: #fee2e2;
            color: #991b1b;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #ef4444;
            display: none;
        }

        .checkbox-field {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-field input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .record-type-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .record-type-badge.CHECK {
            background: #dbeafe;
            color: #1e40af;
        }

        .record-type-badge.TEXT {
            background: #dcfce7;
            color: #166534;
        }

        .record-type-badge.TIME {
            background: #fef3c7;
            color: #92400e;
        }

        @media (max-width: 968px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .header-actions {
                flex-direction: column;
                width: 100%;
            }

            .header-actions .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <!-- ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ê²½ìš° -->
    <div id="loginSection">
        <div class="login-card">
            <h2>ğŸ” ë¡œê·¸ì¸</h2>
            <div id="loginError"></div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="email">ì´ë©”ì¼</label>
                    <input type="email" id="email" required placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div class="form-group">
                    <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="password" required placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">ë¡œê·¸ì¸</button>
            </form>
            <div style="text-align: center; margin-top: 20px; color: #666;">
                ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? <a href="#" id="showSignup" style="color: #f5576c; text-decoration: none;">íšŒì›ê°€ì…</a>
            </div>
        </div>
    </div>

    <!-- íšŒì›ê°€ì… -->
    <div id="signupSection" style="display: none;">
        <div class="login-card">
            <h2>ğŸ“ íšŒì›ê°€ì…</h2>
            <div id="signupError"></div>
            <form id="signupForm">
                <div class="form-group">
                    <label for="signupUsername">ì‚¬ìš©ìëª…</label>
                    <input type="text" id="signupUsername" required placeholder="ì‚¬ìš©ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div class="form-group">
                    <label for="signupEmail">ì´ë©”ì¼</label>
                    <input type="email" id="signupEmail" required placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div class="form-group">
                    <label for="signupPassword">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="signupPassword" required placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div class="form-group">
                    <label for="signupTitle">íƒ€ì´í‹€ (ì„ íƒ)</label>
                    <input type="text" id="signupTitle" placeholder="íƒ€ì´í‹€ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div class="form-group">
                    <label for="signupDescription">ì„¤ëª… (ì„ íƒ)</label>
                    <textarea id="signupDescription" placeholder="ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-bottom: 10px;">íšŒì›ê°€ì…</button>
                <button type="button" id="cancelSignup" class="btn btn-secondary" style="width: 100%;">ì·¨ì†Œ</button>
            </form>
        </div>
    </div>

    <!-- ë©”ì¸ ì»¨í…ì¸  (ë¡œê·¸ì¸ í›„) -->
    <div id="mainSection" style="display: none;">
        <div class="header">
            <h1>âœï¸ ë°ì´í„° ì…ë ¥</h1>
            <div class="header-actions">
                <span class="user-info" id="userInfo"></span>
                <a href="index.html" class="btn btn-secondary">ë°ì´í„° ì¡°íšŒ</a>
                <button class="btn btn-danger" id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </div>

        <div class="main-content">
            <!-- ì¹´í…Œê³ ë¦¬ ì¶”ê°€ -->
            <div class="card">
                <h3>ğŸ“ ì¹´í…Œê³ ë¦¬ ì¶”ê°€</h3>
                <div id="categoryMessage"></div>
                <form id="categoryForm">
                    <div class="form-group">
                        <label for="categoryTitle">ì¹´í…Œê³ ë¦¬ ì œëª© *</label>
                        <input type="text" id="categoryTitle" required placeholder="ì˜ˆ: ìš´ë™ ê¸°ë¡">
                    </div>
                    <div class="form-group">
                        <label for="categoryDescription">ì„¤ëª…</label>
                        <textarea id="categoryDescription" placeholder="ì¹´í…Œê³ ë¦¬ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="recordType">ë ˆì½”ë“œ íƒ€ì… *</label>
                        <select id="recordType" required>
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="CHECK">CHECK - ì²´í¬ í•­ëª© (ì„±ê³µ/ì‹¤íŒ¨)</option>
                            <option value="TEXT">TEXT - í…ìŠ¤íŠ¸ ê¸°ë¡</option>
                            <option value="TIME">TIME - ë‚ ì§œ ê¸°ë¡</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-success" style="width: 100%;">
                        ì¹´í…Œê³ ë¦¬ ì¶”ê°€
                    </button>
                </form>
            </div>

            <!-- ë ˆì½”ë“œ ì¶”ê°€ -->
            <div class="card">
                <h3>ğŸ“ ë ˆì½”ë“œ ì¶”ê°€</h3>
                <div id="recordMessage"></div>

                <!-- ì¹´í…Œê³ ë¦¬ ì„ íƒ -->
                <div class="category-select">
                    <label>ì¹´í…Œê³ ë¦¬ ì„ íƒ *</label>
                    <select id="selectedCategory">
                        <option value="">ë¨¼ì € ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                    </select>
                </div>

                <!-- íƒ­ -->
                <div class="tabs">
                    <button class="tab active" data-tab="check">âœ… CHECK</button>
                    <button class="tab" data-tab="text">ğŸ“„ TEXT</button>
                    <button class="tab" data-tab="time">ğŸ“… TIME</button>
                </div>

                <!-- CHECK ë ˆì½”ë“œ ì¶”ê°€ -->
                <div id="checkTab" class="tab-content active">
                    <form id="checkForm">
                        <div class="form-group">
                            <label class="checkbox-field">
                                <input type="checkbox" id="checkSuccess">
                                <span>ì„±ê³µ ì—¬ë¶€</span>
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            CHECK ë ˆì½”ë“œ ì¶”ê°€
                        </button>
                    </form>
                </div>

                <!-- TEXT ë ˆì½”ë“œ ì¶”ê°€ -->
                <div id="textTab" class="tab-content">
                    <form id="textForm">
                        <div class="form-group">
                            <label for="textTitle">ì œëª© *</label>
                            <input type="text" id="textTitle" required placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                        </div>
                        <div class="form-group">
                            <label for="textContent">ë‚´ìš© *</label>
                            <textarea id="textContent" required placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            TEXT ë ˆì½”ë“œ ì¶”ê°€
                        </button>
                    </form>
                </div>

                <!-- TIME ë ˆì½”ë“œ ì¶”ê°€ -->
                <div id="timeTab" class="tab-content">
                    <form id="timeForm">
                        <div class="form-group">
                            <label for="timeDate">ë‚ ì§œ *</label>
                            <input type="date" id="timeDate" required>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            TIME ë ˆì½”ë“œ ì¶”ê°€
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const API_BASE = 'http://localhost:8080/api';
    let currentUser = null;
    let categories = [];

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¸ì¦ í™•ì¸
    window.addEventListener('DOMContentLoaded', async () => {
        await checkAuth();
    });

    // íƒ­ ì „í™˜
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
            const tabName = tab.dataset.tab;

            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

            // ì„ íƒëœ íƒ­ í™œì„±í™”
            tab.classList.add('active');
            document.getElementById(`${tabName}Tab`).classList.add('active');
        });
    });

    // ì¸ì¦ í™•ì¸
    async function checkAuth() {
        try {
            const response = await fetch(`${API_BASE}/auth/me`, {
                credentials: 'include'
            });

            if (response.ok) {
                const data = await response.json();
                currentUser = data;
                showMainSection();
                await loadCategories();
            } else {
                showLoginSection();
            }
        } catch (error) {
            console.error('ì¸ì¦ í™•ì¸ ì‹¤íŒ¨:', error);
            showLoginSection();
        }
    }

    // ë¡œê·¸ì¸
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        try {
            const response = await fetch(`${API_BASE}/auth/login`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                credentials: 'include',
                body: JSON.stringify({ email, password })
            });

            if (response.ok) {
                await checkAuth();
            } else {
                const error = await response.json();
                showError('loginError', error.message || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        } catch (error) {
            console.error('ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
            showError('loginError', 'ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    });

    // íšŒì›ê°€ì… í‘œì‹œ
    document.getElementById('showSignup').addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('signupSection').style.display = 'block';
    });

    // íšŒì›ê°€ì… ì·¨ì†Œ
    document.getElementById('cancelSignup').addEventListener('click', () => {
        document.getElementById('signupSection').style.display = 'none';
        document.getElementById('loginSection').style.display = 'block';
    });

    // íšŒì›ê°€ì…
    document.getElementById('signupForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const signupData = {
            username: document.getElementById('signupUsername').value,
            email: document.getElementById('signupEmail').value,
            password: document.getElementById('signupPassword').value,
            title: document.getElementById('signupTitle').value || '',
            description: document.getElementById('signupDescription').value || ''
        };

        try {
            const response = await fetch(`${API_BASE}/auth/signup`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(signupData)
            });

            if (response.ok) {
                showSuccess('signupError', 'íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
                setTimeout(() => {
                    document.getElementById('signupSection').style.display = 'none';
                    document.getElementById('loginSection').style.display = 'block';
                }, 1500);
            } else {
                const error = await response.json();
                showError('signupError', error.message || 'íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        } catch (error) {
            console.error('íšŒì›ê°€ì… ì˜¤ë¥˜:', error);
            showError('signupError', 'íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    });

    // ë¡œê·¸ì•„ì›ƒ
    document.getElementById('logoutBtn').addEventListener('click', async () => {
        try {
            await fetch(`${API_BASE}/auth/logout`, {
                method: 'POST',
                credentials: 'include'
            });
            currentUser = null;
            showLoginSection();
        } catch (error) {
            console.error('ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:', error);
        }
    });

    // ì¹´í…Œê³ ë¦¬ ë¡œë“œ
    async function loadCategories() {
        try {
            const response = await fetch(`${API_BASE}/category`, {
                credentials: 'include'
            });

            if (response.ok) {
                categories = await response.json();
                updateCategorySelect();
            }
        } catch (error) {
            console.error('ì¹´í…Œê³ ë¦¬ ë¡œë“œ ì˜¤ë¥˜:', error);
        }
    }

    // ì¹´í…Œê³ ë¦¬ ì…€ë ‰íŠ¸ ì—…ë°ì´íŠ¸
    function updateCategorySelect() {
        const select = document.getElementById('selectedCategory');

        if (!categories || categories.length === 0) {
            select.innerHTML = '<option value="">ë“±ë¡ëœ ì¹´í…Œê³ ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤</option>';
            return;
        }

        select.innerHTML = '<option value="">ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>';
        categories.forEach(category => {
            const option = document.createElement('option');
            option.value = category.id;
            option.dataset.type = category.recordType;
            option.textContent = `${category.title} (${category.recordType})`;
            select.appendChild(option);
        });
    }

    // ì¹´í…Œê³ ë¦¬ ì¶”ê°€
    document.getElementById('categoryForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const categoryData = {
            title: document.getElementById('categoryTitle').value,
            description: document.getElementById('categoryDescription').value,
            recordType: document.getElementById('recordType').value
        };

        try {
            const response = await fetch(`${API_BASE}/category?addCategory=${encodeURIComponent(JSON.stringify(categoryData))}`, {
                method: 'POST',
                credentials: 'include'
            });

            if (response.ok) {
                showMessage('categoryMessage', 'ì¹´í…Œê³ ë¦¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                document.getElementById('categoryForm').reset();
                await loadCategories();
            } else {
                const error = await response.json();
                showMessage('categoryMessage', error.message || 'ì¹´í…Œê³ ë¦¬ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        } catch (error) {
            console.error('ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì˜¤ë¥˜:', error);
            showMessage('categoryMessage', 'ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
        }
    });

    // CHECK ë ˆì½”ë“œ ì¶”ê°€
    document.getElementById('checkForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const categoryId = document.getElementById('selectedCategory').value;
        if (!categoryId) {
            showMessage('recordMessage', 'ì¹´í…Œê³ ë¦¬ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
            return;
        }

        const selectedOption = document.getElementById('selectedCategory').selectedOptions[0];
        if (selectedOption.dataset.type !== 'CHECK') {
            showMessage('recordMessage', 'CHECK íƒ€ì… ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
            return;
        }

        const checkData = {
            categoryId: categoryId,
            success: document.getElementById('checkSuccess').checked
        };

        try {
            const response = await fetch(`${API_BASE}/check?saveCheck=${encodeURIComponent(JSON.stringify(checkData))}`, {
                method: 'POST',
                credentials: 'include'
            });

            if (response.ok) {
                showMessage('recordMessage', 'CHECK ë ˆì½”ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                document.getElementById('checkForm').reset();
            } else {
                const error = await response.json();
                showMessage('recordMessage', error.message || 'ë ˆì½”ë“œ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        } catch (error) {
            console.error('CHECK ë ˆì½”ë“œ ì¶”ê°€ ì˜¤ë¥˜:', error);
            showMessage('recordMessage', 'ë ˆì½”ë“œ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
        }
    });

    // TEXT ë ˆì½”ë“œ ì¶”ê°€
    document.getElementById('textForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const categoryId = document.getElementById('selectedCategory').value;
        if (!categoryId) {
            showMessage('recordMessage', 'ì¹´í…Œê³ ë¦¬ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
            return;
        }

        const selectedOption = document.getElementById('selectedCategory').selectedOptions[0];
        if (selectedOption.dataset.type !== 'TEXT') {
            showMessage('recordMessage', 'TEXT íƒ€ì… ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
            return;
        }

        const textData = {
            categoryId: categoryId,
            title: document.getElementById('textTitle').value,
            text: document.getElementById('textContent').value
        };

        try {
            const response = await fetch(`${API_BASE}/text?dto=${encodeURIComponent(JSON.stringify(textData))}`, {
                method: 'POST',
                credentials: 'include'
            });

            if (response.ok) {
                showMessage('recordMessage', 'TEXT ë ˆì½”ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                document.getElementById('textForm').reset();
            } else {
                const error = await response.json();
                showMessage('recordMessage', error.message || 'ë ˆì½”ë“œ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        } catch (error) {
            console.error('TEXT ë ˆì½”ë“œ ì¶”ê°€ ì˜¤ë¥˜:', error);
            showMessage('recordMessage', 'ë ˆì½”ë“œ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
        }
    });

    // TIME ë ˆì½”ë“œ ì¶”ê°€
    document.getElementById('timeForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const categoryId = document.getElementById('selectedCategory').value;
        if (!categoryId) {
            showMessage('recordMessage', 'ì¹´í…Œê³ ë¦¬ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
            return;
        }

        const selectedOption = document.getElementById('selectedCategory').selectedOptions[0];
        if (selectedOption.dataset.type !== 'TIME') {
            showMessage('recordMessage', 'TIME íƒ€ì… ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
            return;
        }

        const timeData = {
            categoryId: categoryId,
            date: document.getElementById('timeDate').value
        };

        try {
            const response = await fetch(`${API_BASE}/time?dto=${encodeURIComponent(JSON.stringify(timeData))}`, {
                method: 'POST',
                credentials: 'include'
            });

            if (response.ok) {
                showMessage('recordMessage', 'TIME ë ˆì½”ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                document.getElementById('timeForm').reset();
            } else {
                const error = await response.json();
                showMessage('recordMessage', error.message || 'ë ˆì½”ë“œ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        } catch (error) {
            console.error('TIME ë ˆì½”ë“œ ì¶”ê°€ ì˜¤ë¥˜:', error);
            showMessage('recordMessage', 'ë ˆì½”ë“œ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
        }
    });

    // UI í‘œì‹œ í•¨ìˆ˜
    function showLoginSection() {
        document.getElementById('loginSection').style.display = 'block';
        document.getElementById('signupSection').style.display = 'none';
        document.getElementById('mainSection').style.display = 'none';
    }

    function showMainSection() {
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('signupSection').style.display = 'none';
        document.getElementById('mainSection').style.display = 'block';

        if (currentUser) {
            document.getElementById('userInfo').textContent =
                `${currentUser.username || currentUser.email}ë‹˜`;
        }
    }

    function showError(elementId, message) {
        const element = document.getElementById(elementId);
        element.innerHTML = `<div class="error-message" style="display: block;">${message}</div>`;
        setTimeout(() => {
            element.innerHTML = '';
        }, 5000);
    }

    function showSuccess(elementId, message) {
        const element = document.getElementById(elementId);
        element.innerHTML = `<div class="success-message" style="display: block;">${message}</div>`;
    }

    function showMessage(elementId, message, type) {
        const element = document.getElementById(elementId);
        const className = type === 'success' ? 'success-message' : 'error-message';
        element.innerHTML = `<div class="${className}" style="display: block;">${message}</div>`;

        setTimeout(() => {
            element.innerHTML = '';
        }, 5000);
    }
</script>
</body>
</html>