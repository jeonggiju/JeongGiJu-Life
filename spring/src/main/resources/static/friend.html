<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>JeongGiJu - ì¹œêµ¬ ê´€ë¦¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #fff;
            color: #333;
            padding: 32px 36px;
            min-height: 100vh;
        }

        .header {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ddd;
        }

        .greeting {
            font-size: 32px;
            font-weight: normal;
            margin-bottom: 8px;
        }

        .subtitle {
            font-size: 13px;
            color: #666;
            font-weight: normal;
        }

        .top-actions {
            position: absolute;
            top: 40px;
            right: 60px;
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .btn {
            padding: 6px 12px;
            border: 1px solid #ccc;
            background: white;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            text-decoration: none;
            color: #333;
            display: inline-block;
        }

        .btn:hover {
            background: #f0f0f0;
        }

        .btn-primary {
            background: #e0e0e0;
            border-color: #999;
        }

        .btn-primary:hover {
            background: #d0d0d0;
        }

        .btn-danger {
            background: #fff;
            border-color: #ef4444;
            color: #ef4444;
        }

        .btn-danger:hover {
            background: #ef4444;
            color: white;
        }

        .btn-success {
            background: #fff;
            border-color: #10b981;
            color: #10b981;
        }

        .btn-success:hover {
            background: #10b981;
            color: white;
        }

        .language-toggle {
            padding: 6px 12px;
            border: 1px solid #ccc;
            background: white;
            cursor: pointer;
            font-size: 13px;
        }

        .language-toggle:hover {
            background: #f0f0f0;
        }

        /* ë¡œê·¸ì¸/íšŒì›ê°€ì… ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .simple-auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            background: #f5f5f5;
            padding: 20px;
        }

        .simple-auth-box {
            background: white;
            padding: 35px 45px;
            border: 1px solid #ddd;
            min-width: 420px;
            max-width: 480px;
        }

        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .tabs {
            display: flex;
            gap: 0;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 12px 24px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #666;
            transition: all 0.2s;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
        }

        .tab:hover {
            color: #333;
            background: #f9f9f9;
        }

        .tab.active {
            color: #000;
            font-weight: 600;
            border-bottom-color: #333;
        }

        /* íƒ­ ì½˜í…ì¸  */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ì¹œêµ¬ ì¶”ê°€ ì„¹ì…˜ */
        .add-friend-section {
            background: #f9f9f9;
            border: 1px solid #e0e0e0;
            padding: 24px;
            margin-bottom: 30px;
        }

        .add-friend-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #000;
        }

        .search-form {
            display: flex;
            gap: 8px;
            max-width: 600px;
        }

        .search-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ccc;
            font-size: 14px;
            outline: none;
        }

        .search-input:focus {
            border-color: #999;
        }

        /* ì¹œêµ¬/ìš”ì²­ ë¦¬ìŠ¤íŠ¸ */
        .friend-list {
            display: grid;
            gap: 12px;
        }

        .friend-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background: #fff;
            border: 1px solid #ddd;
            transition: all 0.2s;
        }

        .friend-item:hover {
            background: #fafafa;
            border-color: #999;
        }

        .friend-info {
            flex: 1;
        }

        .friend-name {
            font-size: 15px;
            font-weight: 600;
            color: #000;
            margin-bottom: 4px;
        }

        .friend-email {
            font-size: 13px;
            color: #666;
        }

        .friend-date {
            font-size: 12px;
            color: #999;
            margin-top: 4px;
        }

        .friend-actions {
            display: flex;
            gap: 8px;
        }

        .friend-btn {
            padding: 6px 14px;
            border: 1px solid #ccc;
            background: white;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .friend-btn:hover {
            background: #f0f0f0;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
            font-size: 14px;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        /* ê²€ìƒ‰ ê²°ê³¼ */
        .search-results {
            margin-top: 20px;
            max-width: 600px;
        }

        .search-result-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: #fff;
            border: 1px solid #ddd;
            margin-bottom: 8px;
        }

        .search-result-info {
            flex: 1;
        }

        .search-result-name {
            font-size: 14px;
            font-weight: 600;
            color: #000;
            margin-bottom: 2px;
        }

        .search-result-email {
            font-size: 12px;
            color: #666;
        }

        /* ì•Œë¦¼ ë©”ì‹œì§€ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 14px 20px;
            background: #333;
            color: white;
            font-size: 13px;
            border-radius: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification.success {
            background: #10b981;
        }

        .notification.error {
            background: #ef4444;
        }

        /* ë±ƒì§€ */
        .badge {
            display: inline-block;
            padding: 3px 8px;
            background: #e0e0e0;
            font-size: 11px;
            font-weight: 600;
            color: #666;
            margin-left: 8px;
        }

        .badge.pending {
            background: #fef3c7;
            color: #92400e;
        }

        /* ë¡œë”© ìƒíƒœ */
        .loading {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 14px;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        }

        /* ========== NOTIFICATION SYSTEM ========== */

        /* ì•Œë¦¼ ë²¨ ì•„ì´ì½˜ */
        .notification-bell {
            position: relative !important;
            padding: 6px 12px;
            border: 1px solid #ccc;
            background: white;
            cursor: pointer;
            font-size: 18px;
            line-height: 1;
        }

        .notification-bell:hover {
            background: #f0f0f0;
        }

        /* ì½ì§€ ì•Šì€ ì•Œë¦¼ ë°°ì§€ */
        .notification-badge {
            position: absolute !important;
            top: -4px !important;
            right: -4px !important;
            background: #ff0000 !important;
            color: white !important;
            font-size: 10px !important;
            font-weight: 600 !important;
            padding: 2px 6px !important;
            border-radius: 10px !important;
            min-width: 18px !important;
            text-align: center !important;
            z-index: 10 !important;
            pointer-events: none !important;
        }

        /* í† ìŠ¤íŠ¸ ì•Œë¦¼ ì»¨í…Œì´ë„ˆ */
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 350px;
        }

        /* í† ìŠ¤íŠ¸ ì•Œë¦¼ */
        .toast-notification {
            background: white;
            border: 1px solid #ddd;
            border-left: 4px solid #4CAF50;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            animation: slideInRight 0.3s ease-out;
            cursor: pointer;
            transition: all 0.3s ease-out;
        }

        .toast-notification.comment {
            border-left-color: #2196F3;
        }

        .toast-notification.reply {
            border-left-color: #9C27B0;
        }

        .toast-notification.like {
            border-left-color: #ff4081;
        }

        .toast-notification.friend_request {
            border-left-color: #10b981;
        }

        .toast-notification.friend_accept {
            border-left-color: #3b82f6;
        }

        .toast-notification.friend_reject {
            border-left-color: #ef4444;
        }

        .toast-notification:hover {
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }

        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast-title {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 5px;
            color: #333;
        }

        .toast-message {
            font-size: 12px;
            color: #666;
            line-height: 1.4;
        }

        .toast-time {
            font-size: 10px;
            color: #999;
            margin-top: 5px;
        }

        /* ì•Œë¦¼ ëª©ë¡ ëª¨ë‹¬ */
        .notification-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.4);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .notification-modal.active {
            display: flex;
        }

        .notification-modal-content {
            background: white;
            width: 90%;
            max-width: 550px;
            max-height: 75vh;
            overflow-y: auto;
            padding: 0;
            border: 1px solid #ccc;
        }

        .notification-modal-header {
            padding: 14px 16px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background: #fafafa;
            z-index: 1;
        }

        .notification-modal-title {
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        .notification-modal-close {
            background: none;
            border: none;
            font-size: 22px;
            cursor: pointer;
            color: #999;
            padding: 0;
            line-height: 1;
        }

        .notification-modal-close:hover {
            color: #333;
        }

        .mark-all-read-btn {
            padding: 4px 10px;
            background: #333;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 11px;
            font-weight: 500;
        }

        .mark-all-read-btn:hover {
            background: #000;
        }

        .mark-all-read-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .notification-list {
            padding: 0;
        }

        .notification-item {
            padding: 12px 16px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.2s;
        }

        .notification-item:hover {
            background: #f5f5f5;
        }

        .notification-item.unread {
            background: #f0f8ff;
        }

        .notification-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .notification-item-type {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 3px;
            font-weight: 600;
        }

        .notification-item-type.comment { background: #e3f2fd; color: #1976d2; }
        .notification-item-type.reply { background: #f3e5f5; color: #7b1fa2; }
        .notification-item-type.like { background: #fce4ec; color: #c2185b; }
        .notification-item-type.friend_request { background: #d1fae5; color: #065f46; }
        .notification-item-type.friend_accept { background: #dbeafe; color: #1e40af; }
        .notification-item-type.friend_reject { background: #fee2e2; color: #991b1b; }

        .notification-item-time {
            font-size: 11px;
            color: #999;
        }

        .notification-item-content {
            font-size: 13px;
            color: #333;
            line-height: 1.4;
        }

        .notification-item-sender {
            font-weight: 600;
            color: #555;
        }

        .notification-empty {
            padding: 50px 20px;
            text-align: center;
            color: #999;
            font-size: 12px;
        }
            color: #666;
        }

        .notification-empty {
            padding: 60px 20px;
            text-align: center;
            color: #999;
            font-size: 13px;
        }
    </style>
</head>
<body>
<!-- ë¡œê·¸ì¸ ì„¹ì…˜ -->
<div id="loginSection" style="display: block; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000;">
    <div class="simple-auth-container">
        <div class="simple-auth-box">
            <div style="text-align: left; margin-bottom: 10px;">
                <a href="index.html" style="color: #666; text-decoration: none; font-size: 13px;">â† Back to Home</a>
            </div>
            <h2 style="text-align: center; margin-bottom: 30px; font-size: 20px; font-weight: 600;">Sign In</h2>
            <div id="loginError" style="color: red; margin-bottom: 10px; text-align: center; font-size: 13px;"></div>
            <form id="loginForm">
                <table style="margin: 0 auto; border-collapse: collapse;">
                    <tr>
                        <td style="text-align: right; padding: 5px 10px 5px 0; font-size: 14px;">Email:</td>
                        <td style="padding: 5px 0;"><input type="email" id="email" required style="padding: 5px; width: 200px; border: 1px solid #999; font-size: 14px;"></td>
                    </tr>
                    <tr>
                        <td style="text-align: right; padding: 5px 10px 5px 0; font-size: 14px;">Password:</td>
                        <td style="padding: 5px 0;"><input type="password" id="password" required style="padding: 5px; width: 200px; border: 1px solid #999; font-size: 14px;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: center; padding-top: 15px;">
                            <button type="submit" style="padding: 6px 20px; border: 1px solid #999; background: #f0f0f0; cursor: pointer; font-size: 14px;">Sign In</button>
                        </td>
                    </tr>
                </table>
            </form>
            <div style="text-align: center; margin-top: 20px; font-size: 12px;">
                New account? <a href="#" id="showSignup" style="color: #0066cc; text-decoration: underline;">Sign Up</a>
            </div>
        </div>
    </div>
</div>

<!-- íšŒì›ê°€ì… ì„¹ì…˜ -->
<div id="signupSection" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000;">
    <div class="simple-auth-container">
        <div class="simple-auth-box">
            <div style="text-align: left; margin-bottom: 10px;">
                <a href="index.html" style="color: #666; text-decoration: none; font-size: 13px;">â† Back to Home</a>
            </div>
            <h2 style="text-align: center; margin-bottom: 30px; font-size: 20px; font-weight: 600;">Sign Up</h2>
            <div id="signupError" style="color: red; margin-bottom: 10px; text-align: center; font-size: 13px;"></div>
            <form id="signupForm">
                <table style="width: 100%; border-collapse: collapse;">
                    <tr>
                        <td style="padding: 8px 0; width: 100px; font-size: 13px;">Username:</td>
                        <td style="padding: 8px 0;">
                            <input type="text" id="signupUsername" required style="width: 100%; padding: 6px; border: 1px solid #ccc; font-size: 13px;">
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 8px 0; font-size: 13px;">Email:</td>
                        <td style="padding: 8px 0;">
                            <input type="email" id="signupEmail" required style="width: 100%; padding: 6px; border: 1px solid #ccc; font-size: 13px;">
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 8px 0; font-size: 13px;">Password:</td>
                        <td style="padding: 8px 0;">
                            <input type="password" id="signupPassword" required style="width: 100%; padding: 6px; border: 1px solid #ccc; font-size: 13px;">
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 8px 0; font-size: 13px;">Title:</td>
                        <td style="padding: 8px 0;">
                            <input type="text" id="signupTitle" style="width: 100%; padding: 6px; border: 1px solid #ccc; font-size: 13px;">
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 8px 0; font-size: 13px;">Description:</td>
                        <td style="padding: 8px 0;">
                            <textarea id="signupDescription" style="width: 100%; padding: 6px; border: 1px solid #ccc; font-size: 13px; min-height: 60px;"></textarea>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 8px 0; font-size: 13px;">Birth Date:</td>
                        <td style="padding: 8px 0; display: flex; gap: 5px;">
                            <input type="number" id="signupYear" placeholder="YYYY" min="1900" max="2024" required style="flex: 2; padding: 6px; border: 1px solid #ccc; font-size: 13px;">
                            <input type="number" id="signupMonth" placeholder="MM" min="1" max="12" required style="flex: 1; padding: 6px; border: 1px solid #ccc; font-size: 13px;">
                            <input type="number" id="signupDay" placeholder="DD" min="1" max="31" required style="flex: 1; padding: 6px; border: 1px solid #ccc; font-size: 13px;">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: center; padding-top: 15px;">
                            <button type="submit" style="padding: 6px 20px; border: 1px solid #999; background: #f0f0f0; cursor: pointer; font-size: 14px;">Sign Up</button>
                        </td>
                    </tr>
                </table>
            </form>
            <div style="text-align: center; margin-top: 20px; font-size: 12px;">
                Already have an account? <a href="#" id="showLogin2" style="color: #0066cc; text-decoration: underline;">Sign In</a>
            </div>
        </div>
    </div>
</div>

<!-- ì¹œêµ¬ ê´€ë¦¬ ë©”ì¸ ì½˜í…ì¸  -->
<div id="mainSection" style="display: none;">
    <div class="top-actions">
        <button class="language-toggle" onclick="toggleLanguage()" data-lang-ko="EN" data-lang-en="KO">EN</button>
        <a href="index.html" class="btn" data-lang-ko="í™ˆ" data-lang-en="Home">í™ˆ</a>
        <a href="manage.html" class="btn" data-lang-ko="ë°ì´í„° ê´€ë¦¬" data-lang-en="View Data">ë°ì´í„° ê´€ë¦¬</a>
        <a href="insert.html" class="btn" data-lang-ko="ì¹´í…Œê³ ë¦¬ ê´€ë¦¬" data-lang-en="Manage Categories">ì¹´í…Œê³ ë¦¬ ê´€ë¦¬</a>
        <button class="notification-bell" id="notificationBell" onclick="toggleNotificationModal()" style="position: relative !important; padding: 6px 12px !important; font-size: 18px !important; line-height: 1 !important;">
            ğŸ””
            <span class="notification-badge" id="notificationBadge" style="display: none; position: absolute !important; top: -4px !important; right: -4px !important; background: #ff0000 !important; color: white !important; font-size: 10px !important; padding: 2px 6px !important; border-radius: 10px !important; z-index: 10 !important;">0</span>
        </button>
        <button class="btn btn-primary" onclick="logout()" data-lang-ko="ë¡œê·¸ì•„ì›ƒ" data-lang-en="Logout">ë¡œê·¸ì•„ì›ƒ</button>
    </div>

    <div class="header">
        <h1 class="greeting" data-lang-ko="ì¹œêµ¬ ê´€ë¦¬" data-lang-en="Friends">ì¹œêµ¬ ê´€ë¦¬</h1>
        <p class="subtitle" data-lang-ko="ì¹œêµ¬ë¥¼ ì¶”ê°€í•˜ê³  ìš”ì²­ì„ ê´€ë¦¬í•˜ì„¸ìš”" data-lang-en="Add friends and manage requests">ì¹œêµ¬ë¥¼ ì¶”ê°€í•˜ê³  ìš”ì²­ì„ ê´€ë¦¬í•˜ì„¸ìš”</p>
    </div>

    <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="tabs">
        <button class="tab active" onclick="showTab('friends', event)" data-lang-ko="ë‚´ ì¹œêµ¬" data-lang-en="My Friends">ë‚´ ì¹œêµ¬</button>
        <button class="tab" onclick="showTab('incoming', event)" data-lang-ko="ë°›ì€ ìš”ì²­" data-lang-en="Received Requests">ë°›ì€ ìš”ì²­</button>
        <button class="tab" onclick="showTab('outgoing', event)" data-lang-ko="ë³´ë‚¸ ìš”ì²­" data-lang-en="Sent Requests">ë³´ë‚¸ ìš”ì²­</button>
        <button class="tab" onclick="showTab('add', event)" data-lang-ko="ì¹œêµ¬ ì¶”ê°€" data-lang-en="Add Friend">ì¹œêµ¬ ì¶”ê°€</button>
    </div>

    <!-- ë‚´ ì¹œêµ¬ íƒ­ -->
    <div id="friends-tab" class="tab-content active">
        <div id="friends-list" class="friend-list">
            <div class="loading" data-lang-ko="ì¹œêµ¬ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘" data-lang-en="Loading friends">ì¹œêµ¬ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘</div>
        </div>
    </div>

    <!-- ë°›ì€ ìš”ì²­ íƒ­ -->
    <div id="incoming-tab" class="tab-content">
        <div id="incoming-list" class="friend-list">
            <div class="loading" data-lang-ko="ë°›ì€ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘" data-lang-en="Loading incoming requests">ë°›ì€ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘</div>
        </div>
    </div>

    <!-- ë³´ë‚¸ ìš”ì²­ íƒ­ -->
    <div id="outgoing-tab" class="tab-content">
        <div id="outgoing-list" class="friend-list">
            <div class="loading" data-lang-ko="ë³´ë‚¸ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘" data-lang-en="Loading outgoing requests">ë³´ë‚¸ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘</div>
        </div>
    </div>

    <!-- ì¹œêµ¬ ì¶”ê°€ íƒ­ -->
    <div id="add-tab" class="tab-content">
        <div class="add-friend-section">
            <h2 class="add-friend-title" data-lang-ko="ì´ë©”ì¼ë¡œ ì¹œêµ¬ ì°¾ê¸°" data-lang-en="Find Friend by Email">ì´ë©”ì¼ë¡œ ì¹œêµ¬ ì°¾ê¸°</h2>
            <form class="search-form" onsubmit="searchUser(event)">
                <input
                        type="email"
                        class="search-input"
                        id="search-email"
                        placeholder="friend@example.com"
                        required
                />
                <button type="submit" class="btn btn-primary" data-lang-ko="ê²€ìƒ‰" data-lang-en="Search">ê²€ìƒ‰</button>
            </form>
            <div id="search-results" class="search-results"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080/api';
        const TOKEN_KEY = 'accessToken';
        let currentLanguage = 'ko';

        // ========== fetchEventSource ìì²´ êµ¬í˜„ ==========
        window.fetchEventSource = async function(url, options) {
            const {
                onopen,
                onmessage,
                onerror,
                onclose,
                signal,
                headers = {},
                ...fetchOptions
            } = options;

            try {
                const response = await fetch(url, {
                    ...fetchOptions,
                    headers: headers,
                    signal: signal
                });

                // onopen ì½œë°± í˜¸ì¶œ
                if (onopen) {
                    await onopen(response);
                }

                // ì‘ë‹µì´ ì‹¤íŒ¨ë©´ ì—ëŸ¬
                if (!response.ok) {
                    throw new Error(`HTTP Error: ${response.status}`);
                }

                // ReadableStreamìœ¼ë¡œ SSE íŒŒì‹±
                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                let buffer = '';

                while (true) {
                    const { done, value } = await reader.read();

                    if (done) {
                        if (onclose) onclose();
                        break;
                    }

                    // ì²­í¬ë¥¼ ë²„í¼ì— ì¶”ê°€
                    buffer += decoder.decode(value, { stream: true });

                    // \n\nìœ¼ë¡œ ì´ë²¤íŠ¸ ë¶„ë¦¬
                    const lines = buffer.split('\n\n');
                    buffer = lines.pop() || ''; // ë§ˆì§€ë§‰ ë¶ˆì™„ì „í•œ ì¤„ì€ ë²„í¼ì— ìœ ì§€

                    // ê° ì´ë²¤íŠ¸ ì²˜ë¦¬
                    for (const eventText of lines) {
                        if (eventText.trim() === '') continue;

                        const event = { event: 'message', data: '' };
                        const eventLines = eventText.split('\n');

                        for (const line of eventLines) {
                            if (line.startsWith('event:')) {
                                event.event = line.substring(6).trim();
                            } else if (line.startsWith('data:')) {
                                if (event.data) event.data += '\n';
                                event.data += line.substring(5).trim();
                            }
                        }

                        // onmessage ì½œë°± í˜¸ì¶œ
                        if (onmessage && event.data) {
                            try {
                                onmessage(event);
                            } catch (err) {
                                console.error('onmessage ì—ëŸ¬:', err);
                            }
                        }
                    }
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    console.log('fetchEventSource: ì—°ê²°ì´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else {
                    console.error('fetchEventSource ì—ëŸ¬:', error);
                    if (onerror) {
                        onerror(error);
                    }
                }
                throw error;
            }
        };

        // ========== í† í° ê´€ë¦¬ ==========

        function setAccessToken(token) {
            if (token) {
                localStorage.setItem(TOKEN_KEY, token);
            } else {
                localStorage.removeItem(TOKEN_KEY);
            }
        }

        function getAccessToken() {
            return localStorage.getItem(TOKEN_KEY);
        }

        function removeAccessToken() {
            localStorage.removeItem(TOKEN_KEY);
        }

        async function refreshAccessToken() {
            try {
                const response = await fetch(`${API_BASE}/auth/refresh`, {
                    method: 'POST',
                    credentials: 'include'
                });

                if (response.ok) {
                    const data = await response.json();
                    setAccessToken(data.accessToken);
                    console.log('âœ… Access í† í° ê°±ì‹  ì„±ê³µ');
                    return data.accessToken;
                } else {
                    console.log('âŒ Refresh í† í° ë§Œë£Œ');
                    removeAccessToken();
                    return null;
                }
            } catch (error) {
                console.error('í† í° ê°±ì‹  ì˜¤ë¥˜:', error);
                removeAccessToken();
                return null;
            }
        }

        async function apiCall(url, options = {}) {
            const fullUrl = url.startsWith('http') ? url : `${API_BASE}${url}`;

            const defaultOptions = {
                credentials: 'include',
                headers: {
                    'Content-Type': 'application/json',
                    ...options.headers
                }
            };

            const token = getAccessToken();
            if (token) {
                defaultOptions.headers['Authorization'] = `Bearer ${token}`;
            }

            const finalOptions = { ...defaultOptions, ...options };
            if (options.headers) {
                finalOptions.headers = { ...defaultOptions.headers, ...options.headers };
            }

            try {
                let response = await fetch(fullUrl, finalOptions);

                if (response.status === 401) {
                    console.log('ğŸ”„ í† í° ë§Œë£Œ, ê°±ì‹  ì‹œë„...');
                    const newToken = await refreshAccessToken();

                    if (newToken) {
                        finalOptions.headers['Authorization'] = `Bearer ${newToken}`;
                        response = await fetch(fullUrl, finalOptions);
                    } else {
                        throw new Error('LOGIN_REQUIRED');
                    }
                }

                return response;
            } catch (error) {
                throw error;
            }
        }

        // Notification system variables
        let notifications = [];
        let unreadCount = 0;
        let eventSource = null;
        let sseReconnectAttempts = 0;
        const MAX_SSE_RECONNECT = 3;

        // ì–¸ì–´ ì „í™˜
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'ko' ? 'en' : 'ko';
            applyLanguage();
        }

        function applyLanguage() {
            const elements = document.querySelectorAll('[data-lang-ko]');
            elements.forEach(el => {
                const text = el.getAttribute(`data-lang-${currentLanguage}`);
                if (text) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                        el.placeholder = text;
                    } else {
                        el.textContent = text;
                    }
                }
            });
        }

        // ì„¹ì…˜ ì „í™˜ í•¨ìˆ˜ë“¤
        function showLoginSection() {
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('signupSection').style.display = 'none';
            document.getElementById('mainSection').style.display = 'none';
        }

        function showSignupSection() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('signupSection').style.display = 'block';
            document.getElementById('mainSection').style.display = 'none';
        }

        function showMainSection() {
            console.log('>>> showMainSection í˜¸ì¶œ');
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('signupSection').style.display = 'none';
            document.getElementById('mainSection').style.display = 'block';

            console.log('>>> ì¹œêµ¬ ëª©ë¡ ë¡œë“œ');
            loadFriends();

            console.log('>>> ì•Œë¦¼ ì‹œìŠ¤í…œ ì´ˆê¸°í™”');
            loadUnreadNotifications();
            connectSSE();

            console.log('>>> showMainSection ì™„ë£Œ');
        }

        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = message;
                setTimeout(() => {
                    element.textContent = '';
                }, 5000);
            }
        }

        // ë¡œê·¸ì¸
        async function login(e) {
            e.preventDefault();

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({ email, password })
                });

                if (response.ok) {
                    // ë¡œê·¸ì¸ ì„±ê³µ í›„ ì¦‰ì‹œ access í† í° ë°›ê¸°
                    const newToken = await refreshAccessToken();
                    if (newToken) {
                        console.log('âœ… ë¡œê·¸ì¸ ì„±ê³µ');
                        showMainSection();
                    } else {
                        showError('loginError', currentLanguage === 'ko' ? 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' : 'Login failed.');
                    }
                } else {
                    showError('loginError', currentLanguage === 'ko' ? 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' : 'Login failed.');
                }
            } catch (error) {
                console.error('Login error:', error);
                showError('loginError', currentLanguage === 'ko' ? 'ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' : 'Error during login.');
            }
        }

        // íšŒì›ê°€ì…
        async function signup(e) {
            e.preventDefault();

            const signupData = {
                username: document.getElementById('signupUsername').value,
                email: document.getElementById('signupEmail').value,
                password: document.getElementById('signupPassword').value,
                title: document.getElementById('signupTitle').value || '',
                description: document.getElementById('signupDescription').value || '',
                birthYear: parseInt(document.getElementById('signupYear').value) || null,
                birthMonth: parseInt(document.getElementById('signupMonth').value) || null,
                birthDay: parseInt(document.getElementById('signupDay').value) || null
            };

            try {
                const response = await fetch(`${API_BASE}/auth/signup`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(signupData)
                });

                if (response.ok) {
                    alert(currentLanguage === 'ko' ? 'íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.' : 'Signup complete. Please login.');
                    showLoginSection();
                } else {
                    const errorText = await response.text();
                    showError('signupError', errorText || (currentLanguage === 'ko' ? 'íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' : 'Signup failed.'));
                }
            } catch (error) {
                console.error('Signup error:', error);
                showError('signupError', currentLanguage === 'ko' ? 'íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' : 'Error during signup.');
            }
        }

        // ë¡œê·¸ì•„ì›ƒ
        async function logout() {
            try {
                await fetch(`${API_BASE}/auth/logout`, {
                    method: 'POST',
                    credentials: 'include'
                });
            } catch (error) {
                console.error('Logout error:', error);
            } finally {
                removeAccessToken();
                disconnectSSE();
                showLoginSection();
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
        async function checkLoginStatus() {
            console.log('ğŸ” ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸...');
            const token = getAccessToken();

            // í† í°ì´ ì—†ìœ¼ë©´ refresh ì‹œë„
            if (!token) {
                console.log('í† í° ì—†ìŒ, refresh ì‹œë„...');
                const newToken = await refreshAccessToken();
                if (newToken) {
                    console.log('âœ… Refresh ì„±ê³µ');
                    showMainSection();
                    return;
                }
            } else {
                // í† í°ì´ ìˆìœ¼ë©´ ìœ íš¨ì„± ê²€ì‚¬
                try {
                    const response = await apiCall('/user');
                    if (response.ok) {
                        console.log('âœ… í† í° ìœ íš¨');
                        showMainSection();
                        return;
                    }
                } catch (error) {
                    if (error.message === 'LOGIN_REQUIRED') {
                        console.log('âŒ í† í° ë§Œë£Œ');
                    } else {
                        console.error('ì¸ì¦ í™•ì¸ ì˜¤ë¥˜:', error);
                    }
                }
            }

            console.log('ğŸ“ ë¡œê·¸ì¸ í•„ìš”');
            showLoginSection();
        }


        // íƒ­ ì „í™˜
        function showTab(tabName, event) {
            // ëª¨ë“  íƒ­ ë²„íŠ¼ê³¼ ì½˜í…ì¸  ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // ì„ íƒëœ íƒ­ í™œì„±í™”
            if (event) {
                event.target.classList.add('active');
            }
            document.getElementById(`${tabName}-tab`).classList.add('active');

            // íƒ­ë³„ ë°ì´í„° ë¡œë“œ
            if (tabName === 'friends') {
                loadFriends();
            } else if (tabName === 'incoming') {
                loadIncomingRequests();
            } else if (tabName === 'outgoing') {
                loadOutgoingRequests();
            }
        }

        // ì•Œë¦¼ í‘œì‹œ
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // ì¹œêµ¬ ëª©ë¡ ë¡œë“œ
        async function loadFriends() {
            const container = document.getElementById('friends-list');
            container.innerHTML = '<div class="loading" data-lang-ko="ì¹œêµ¬ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘" data-lang-en="Loading friends">ì¹œêµ¬ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘</div>';
            applyLanguage();

            try {
                const friends = await apiCall('/friend');

                if (!friends || friends.length === 0) {
                    container.innerHTML = `
            <div class="empty-state">
                <div data-lang-ko="ì•„ì§ ì¹œêµ¬ê°€ ì—†ìŠµë‹ˆë‹¤" data-lang-en="No friends yet">ì•„ì§ ì¹œêµ¬ê°€ ì—†ìŠµë‹ˆë‹¤</div>
            </div>
        `;
                    applyLanguage();
                    return;
                }

                let html = '';
                friends.forEach(friend => {
                    html += `
            <div class="friend-item">
                <div class="friend-info">
                    <div class="friend-name">${friend.username || friend.email}</div>
                    <div class="friend-email">${friend.email}</div>
                </div>
                <div class="friend-actions">
                    <button class="friend-btn btn-danger" onclick="removeFriend('${friend.friendId}')"
                        data-lang-ko="ì‚­ì œ" data-lang-en="Remove">ì‚­ì œ</button>
                </div>
            </div>
        `;
                });

                container.innerHTML = html;
                applyLanguage();
            } catch (error) {
                console.error('ì¹œêµ¬ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
                container.innerHTML = `
        <div class="empty-state">
            <div data-lang-ko="ì¹œêµ¬ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤" data-lang-en="Failed to load friends">ì¹œêµ¬ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</div>
        </div>
    `;
                applyLanguage();
            }
        }

        // ë°›ì€ ì¹œêµ¬ ìš”ì²­ ë¡œë“œ
        async function loadIncomingRequests() {
            const container = document.getElementById('incoming-list');
            container.innerHTML = '<div class="loading" data-lang-ko="ë°›ì€ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘" data-lang-en="Loading incoming requests">ë°›ì€ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘</div>';
            applyLanguage();

            try {
                const requests = await apiCall('/friend/requests/incoming?status=PENDING');

                if (!requests || requests.length === 0) {
                    container.innerHTML = `
            <div class="empty-state">
                <div data-lang-ko="ë°›ì€ ì¹œêµ¬ ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤" data-lang-en="No incoming requests">ë°›ì€ ì¹œêµ¬ ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤</div>
            </div>
        `;
                    applyLanguage();
                    return;
                }

                let html = '';
                requests.forEach(request => {
                    const date = new Date(request.createdAt).toLocaleDateString('ko-KR');
                    html += `
            <div class="friend-item">
                <div class="friend-info">
                    <div class="friend-name">${request.username || request.email}</div>
                    <div class="friend-email">${request.email}</div>
                    <div class="friend-date">${date}</div>
                </div>
                <div class="friend-actions">
                    <button class="friend-btn btn-success" onclick="acceptRequest('${request.id}')"
                        data-lang-ko="ìˆ˜ë½" data-lang-en="Accept">ìˆ˜ë½</button>
                    <button class="friend-btn btn-danger" onclick="rejectRequest('${request.id}')"
                        data-lang-ko="ê±°ì ˆ" data-lang-en="Reject">ê±°ì ˆ</button>
                </div>
            </div>
        `;
                });

                container.innerHTML = html;
                applyLanguage();
            } catch (error) {
                console.error('ë°›ì€ ìš”ì²­ ë¡œë“œ ì‹¤íŒ¨:', error);
                container.innerHTML = `
        <div class="empty-state">
            <div data-lang-ko="ë°›ì€ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤" data-lang-en="Failed to load incoming requests">ë°›ì€ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</div>
        </div>
    `;
                applyLanguage();
            }
        }

        // ë³´ë‚¸ ì¹œêµ¬ ìš”ì²­ ë¡œë“œ
        async function loadOutgoingRequests() {
            const container = document.getElementById('outgoing-list');
            container.innerHTML = '<div class="loading" data-lang-ko="ë³´ë‚¸ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘" data-lang-en="Loading outgoing requests">ë³´ë‚¸ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘</div>';
            applyLanguage();

            try {
                const requests = await apiCall('/friend/requests/outgoing?status=PENDING');

                if (!requests || requests.length === 0) {
                    container.innerHTML = `
            <div class="empty-state">
                <div data-lang-ko="ë³´ë‚¸ ì¹œêµ¬ ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤" data-lang-en="No outgoing requests">ë³´ë‚¸ ì¹œêµ¬ ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤</div>
            </div>
        `;
                    applyLanguage();
                    return;
                }

                let html = '';
                requests.forEach(request => {
                    const date = new Date(request.createdAt).toLocaleDateString('ko-KR');
                    html += `
            <div class="friend-item">
                <div class="friend-info">
                    <div class="friend-name">${request.username || request.email}</div>
                    <div class="friend-email">${request.email}</div>
                    <div class="friend-date">${date}</div>
                </div>
                <div class="friend-actions">
                    <button class="friend-btn btn-danger" onclick="cancelRequest('${request.id}')"
                        data-lang-ko="ì·¨ì†Œ" data-lang-en="Cancel">ì·¨ì†Œ</button>
                </div>
            </div>
        `;
                });

                container.innerHTML = html;
                applyLanguage();
            } catch (error) {
                console.error('ë³´ë‚¸ ìš”ì²­ ë¡œë“œ ì‹¤íŒ¨:', error);
                container.innerHTML = `
        <div class="empty-state">
            <div data-lang-ko="ë³´ë‚¸ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤" data-lang-en="Failed to load outgoing requests">ë³´ë‚¸ ìš”ì²­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</div>
        </div>
    `;
                applyLanguage();
            }
        }

        // ì‚¬ìš©ì ê²€ìƒ‰
        async function searchUser(event) {
            event.preventDefault();
            const email = document.getElementById('search-email').value.trim();
            const resultsContainer = document.getElementById('search-results');

            if (!email) {
                resultsContainer.innerHTML = '';
                return;
            }

            resultsContainer.innerHTML = '<div class="loading" data-lang-ko="ê²€ìƒ‰ ì¤‘" data-lang-en="Searching">ê²€ìƒ‰ ì¤‘</div>';
            applyLanguage();

            try {
                const response = await apiCall(`/user/search?email=${encodeURIComponent(email)}`);

                // ì‘ë‹µì´ ì—†ê±°ë‚˜ ë¹„ì–´ìˆëŠ” ê²½ìš°
                if (!response || !response.ok) {
                    resultsContainer.innerHTML = `
            <div class="empty-state">
                <div data-lang-ko="ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" data-lang-en="User not found">ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
            </div>
        `;
                    applyLanguage();
                    return;
                }

                const user = await response.json();

                // user ê°ì²´ê°€ ì—†ê±°ë‚˜ ë¹„ì–´ìˆëŠ” ê²½ìš°
                if (!user || !user.id) {
                    resultsContainer.innerHTML = `
            <div class="empty-state">
                <div data-lang-ko="ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤" data-lang-en="No results found">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>
            </div>
        `;
                    applyLanguage();
                    return;
                }

                // ìœ ì € ì •ë³´ í‘œì‹œ
                const userName = user.username || user.email || 'ì´ë¦„ ì—†ìŒ';
                const userEmail = user.email || 'ì´ë©”ì¼ ì—†ìŒ';

                resultsContainer.innerHTML = `
        <div class="search-result-item">
            <div class="search-result-info">
                <div class="search-result-name">${userName}</div>
                <div class="search-result-email">${userEmail}</div>
            </div>
            <button class="btn btn-primary" onclick="sendFriendRequest('${user.id}')"
                data-lang-ko="ì¹œêµ¬ ìš”ì²­" data-lang-en="Send Request">ì¹œêµ¬ ìš”ì²­</button>
        </div>
    `;
                applyLanguage();
            } catch (error) {
                console.error('ì‚¬ìš©ì ê²€ìƒ‰ ì‹¤íŒ¨:', error);
                resultsContainer.innerHTML = `
        <div class="empty-state">
            <div data-lang-ko="ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤" data-lang-en="Search failed">ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</div>
        </div>
    `;
                applyLanguage();
            }
        }

        // ì¹œêµ¬ ìš”ì²­ ë³´ë‚´ê¸°
        async function sendFriendRequest(userId) {
            try {
                await apiCall('/friend/requests', {
                    method: 'POST',
                    body: JSON.stringify({ toUserId: userId })
                });

                // ìš”ì²­ ì „ì†¡ ì„±ê³µ - ì¡°ìš©íˆ ê²€ìƒ‰ ê²°ê³¼ ì´ˆê¸°í™”
                // ê²€ìƒ‰ ê²°ê³¼ ì´ˆê¸°í™”
                document.getElementById('search-email').value = '';
                document.getElementById('search-results').innerHTML = '';
            } catch (error) {
                console.error('ì¹œêµ¬ ìš”ì²­ ì‹¤íŒ¨:', error);
                showNotification(
                    currentLanguage === 'ko' ? 'ì¹œêµ¬ ìš”ì²­ì„ ë³´ë‚´ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤' : 'Failed to send friend request',
                    'error'
                );
            }
        }

        // ì¹œêµ¬ ìš”ì²­ ìˆ˜ë½
        async function acceptRequest(requestId) {
            try {
                await apiCall(`/friend/requests/${requestId}/accept`, {
                    method: 'POST'
                });

                // ìˆ˜ë½ ì„±ê³µ - ìƒëŒ€ë°©ì—ê²Œë§Œ ì•Œë¦¼ì´ ê°€ë¯€ë¡œ ë³¸ì¸ì—ê²ŒëŠ” í† ìŠ¤íŠ¸ ì•Œë¦¼ ë¶ˆí•„ìš”
                loadIncomingRequests();
            } catch (error) {
                console.error('ì¹œêµ¬ ìš”ì²­ ìˆ˜ë½ ì‹¤íŒ¨:', error);
                showNotification(
                    currentLanguage === 'ko' ? 'ì¹œêµ¬ ìš”ì²­ ìˆ˜ë½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤' : 'Failed to accept friend request',
                    'error'
                );
            }
        }

        // ì¹œêµ¬ ìš”ì²­ ê±°ì ˆ
        async function rejectRequest(requestId) {
            if (!confirm(currentLanguage === 'ko' ? 'ì´ ì¹œêµ¬ ìš”ì²­ì„ ê±°ì ˆí•˜ì‹œê² ìŠµë‹ˆê¹Œ?' : 'Reject this friend request?')) {
                return;
            }

            try {
                await apiCall(`/friend/requests/${requestId}/reject`, {
                    method: 'POST'
                });

                // ê±°ì ˆ ì„±ê³µ - ìƒëŒ€ë°©ì—ê²Œë§Œ ì•Œë¦¼ì´ ê°€ë¯€ë¡œ ë³¸ì¸ì—ê²ŒëŠ” í† ìŠ¤íŠ¸ ì•Œë¦¼ ë¶ˆí•„ìš”
                loadIncomingRequests();
            } catch (error) {
                console.error('ì¹œêµ¬ ìš”ì²­ ê±°ì ˆ ì‹¤íŒ¨:', error);
                showNotification(
                    currentLanguage === 'ko' ? 'ì¹œêµ¬ ìš”ì²­ ê±°ì ˆì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤' : 'Failed to reject friend request',
                    'error'
                );
            }
        }

        // ì¹œêµ¬ ìš”ì²­ ì·¨ì†Œ
        async function cancelRequest(requestId) {
            if (!confirm(currentLanguage === 'ko' ? 'ì´ ì¹œêµ¬ ìš”ì²­ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?' : 'Cancel this friend request?')) {
                return;
            }

            try {
                await apiCall(`/friend/requests/${requestId}`, {
                    method: 'DELETE'
                });

                // ì·¨ì†Œ ì„±ê³µ - ì¡°ìš©íˆ ëª©ë¡ë§Œ ê°±ì‹ 
                loadOutgoingRequests();
            } catch (error) {
                console.error('ì¹œêµ¬ ìš”ì²­ ì·¨ì†Œ ì‹¤íŒ¨:', error);
                showNotification(
                    currentLanguage === 'ko' ? 'ì¹œêµ¬ ìš”ì²­ ì·¨ì†Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤' : 'Failed to cancel friend request',
                    'error'
                );
            }
        }

        // ì¹œêµ¬ ì‚­ì œ
        async function removeFriend(friendId) {
            if (!confirm(currentLanguage === 'ko' ? 'ì´ ì¹œêµ¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?' : 'Remove this friend?')) {
                return;
            }

            try {
                await apiCall(`/friend/${friendId}`, {
                    method: 'DELETE'
                });

                // ì‚­ì œ ì„±ê³µ - ì¡°ìš©íˆ ëª©ë¡ë§Œ ê°±ì‹ 
                loadFriends();
            } catch (error) {
                console.error('ì¹œêµ¬ ì‚­ì œ ì‹¤íŒ¨:', error);
                showNotification(
                    currentLanguage === 'ko' ? 'ì¹œêµ¬ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤' : 'Failed to remove friend',
                    'error'
                );
            }
        }

        // ë¡œê·¸ì•„ì›ƒ
        async function logout() {
            if (confirm(currentLanguage === 'ko' ? 'ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?' : 'Do you want to logout?')) {
                try {
                    await fetch(`${API_BASE}/auth/logout`, {
                        method: 'POST',
                        credentials: 'include'
                    });
                } catch (error) {
                    console.error('ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:', error);
                } finally {
                    removeAccessToken();
                }
                window.location.href = 'index.html';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('=== FRIEND.HTML í˜ì´ì§€ ë¡œë“œ ì‹œì‘ ===');

            // ì–¸ì–´ ì ìš©
            applyLanguage();

            // ë¡œê·¸ì¸/íšŒì›ê°€ì… í¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('loginForm').addEventListener('submit', login);
            document.getElementById('signupForm').addEventListener('submit', signup);
            document.getElementById('showSignup').addEventListener('click', (e) => {
                e.preventDefault();
                showSignupSection();
            });
            document.getElementById('showLogin2').addEventListener('click', (e) => {
                e.preventDefault();
                showLoginSection();
            });

            // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
            await checkLoginStatus();
        });

        // ========== NOTIFICATION SYSTEM ==========

        // SSE ì—°ê²°
        // SSE ì—°ê²° ì¤‘ë‹¨ í”Œë˜ê·¸
        let sseAbortController = null;

        // SSE ì—°ê²°
        async function connectSSE() {
            // ê¸°ì¡´ ì—°ê²°ì´ ìˆìœ¼ë©´ ì¤‘ë‹¨
            if (sseAbortController) {
                sseAbortController.abort();
                sseAbortController = null;
            }

            // ìµœëŒ€ ì¬ì—°ê²° íšŸìˆ˜ ì´ˆê³¼ ì‹œ ì¤‘ë‹¨
            if (sseReconnectAttempts >= MAX_SSE_RECONNECT) {
                console.warn('SSE ìµœëŒ€ ì¬ì—°ê²° íšŸìˆ˜ ì´ˆê³¼. ì•Œë¦¼ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤.');
                return;
            }

            // Access Token í™•ì¸
            const token = getAccessToken();
            if (!token) {
                console.warn('Access Token ì—†ìŒ, SSE ì—°ê²° ë¶ˆê°€');
                return;
            }

            console.log(`SSE ì—°ê²° ì‹œë„ (${sseReconnectAttempts + 1}/${MAX_SSE_RECONNECT})`);

            // AbortController ìƒì„±
            sseAbortController = new AbortController();

            try {
                // @microsoft/fetch-event-source ì‚¬ìš©
                await fetchEventSource(`${API_BASE}/sse/subscribe`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`  // âœ… Authorization í—¤ë”!
                    },
                    credentials: 'include',
                    signal: sseAbortController.signal,

                    // ì—°ê²° ì—´ë ¸ì„ ë•Œ
                    onopen: async (response) => {
                        if (response.ok) {
                            console.log('âœ… SSE ì—°ê²° ì„±ê³µ (Authorization header)');
                            sseReconnectAttempts = 0; // ì—°ê²° ì„±ê³µ ì‹œ ì¹´ìš´í„° ë¦¬ì…‹
                            return; // ì •ìƒ ì²˜ë¦¬
                        } else if (response.status === 401) {
                            console.error('âŒ SSE ì¸ì¦ ì‹¤íŒ¨ (401)');
                            throw new Error('Unauthorized');
                        } else {
                            console.error('âŒ SSE ì—°ê²° ì‹¤íŒ¨:', response.status, response.statusText);
                            throw new Error('Connection failed');
                        }
                    },

                    // ë©”ì‹œì§€ ìˆ˜ì‹ 
                    onmessage: (event) => {
                        try {
                            // event.eventëŠ” ì´ë²¤íŠ¸ íƒ€ì… (connected, ping, notification ë“±)
                            const eventType = event.event || 'message';

                            if (eventType === 'connected') {
                                console.log('SSE connected ì´ë²¤íŠ¸ ìˆ˜ì‹ ');
                            } else if (eventType === 'ping') {
                                console.log('SSE ping ìˆ˜ì‹ ');
                            } else if (eventType === 'notification') {
                                const data = JSON.parse(event.data);
                                console.log('ì•Œë¦¼ ìˆ˜ì‹ :', data);
                                handleNotification(data.body || data);
                            }
                        } catch (error) {
                            console.error('ì•Œë¦¼ íŒŒì‹± ì˜¤ë¥˜:', error);
                        }
                    },

                    // ì—ëŸ¬ ë°œìƒ
                    onerror: (error) => {
                        console.error('SSE ì—°ê²° ì˜¤ë¥˜:', error);

                        sseReconnectAttempts++;

                        // ì¬ì—°ê²° ì‹œë„
                        if (sseReconnectAttempts < MAX_SSE_RECONNECT) {
                            console.log(`${5}ì´ˆ í›„ ì¬ì—°ê²° ì‹œë„...`);
                            // fetchEventSourceëŠ” ìë™ìœ¼ë¡œ ì¬ì—°ê²°í•˜ë¯€ë¡œ ìˆ˜ë™ ì¬ì—°ê²°ì€ í•„ìš” ì—†ìŒ
                            // í•˜ì§€ë§Œ ì—ëŸ¬ê°€ ê³„ì†ë˜ë©´ ì¤‘ë‹¨í•˜ê¸° ìœ„í•´ throw
                            throw error;
                        } else {
                            console.warn('SSE ì¬ì—°ê²° ì‹¤íŒ¨. ì•Œë¦¼ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                            throw error; // ì¬ì—°ê²° ì¤‘ë‹¨
                        }
                    },

                    // ì—°ê²° ë‹«í ë•Œ
                    onclose: () => {
                        console.log('SSE ì—°ê²° ì¢…ë£Œ');
                    }
                });
            } catch (error) {
                if (error.name === 'AbortError') {
                    console.log('SSE ì—°ê²°ì´ ìˆ˜ë™ìœ¼ë¡œ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else {
                    console.error('SSE ì´ˆê¸°í™” ì˜¤ë¥˜:', error);

                    // ì¬ì—°ê²° ì‹œë„
                    if (sseReconnectAttempts < MAX_SSE_RECONNECT) {
                        setTimeout(() => {
                            connectSSE();
                        }, 5000);
                    }
                }
            }
        }

        // SSE ì—°ê²° í•´ì œ
        function disconnectSSE() {
            if (sseAbortController) {
                console.log('SSE ì—°ê²° ì¤‘ë‹¨');
                sseAbortController.abort();
                sseAbortController = null;
                sseReconnectAttempts = 0;
            }
        }

        // ì•Œë¦¼ ì²˜ë¦¬
        function handleNotification(notification) {
            notifications.unshift(notification);

            if (isNaN(unreadCount)) {
                unreadCount = 0;
            }

            unreadCount++;
            updateNotificationBadge();
            showToast(notification);

            if (document.getElementById('notificationModal').classList.contains('active')) {
                renderNotificationList();
            }
        }

        // ë°°ì§€ ì—…ë°ì´íŠ¸
        function updateNotificationBadge() {
            const badge = document.getElementById('notificationBadge');
            if (!badge) return;

            if (isNaN(unreadCount)) {
                unreadCount = 0;
            }

            if (unreadCount > 0) {
                const displayCount = unreadCount > 99 ? '99+' : unreadCount;
                badge.textContent = displayCount;
                badge.style.display = 'block';
            } else {
                badge.style.display = 'none';
            }
        }

        // í† ìŠ¤íŠ¸ ì•Œë¦¼ í‘œì‹œ
        function showToast(notification) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast-notification ${notification.type.toLowerCase()}`;

            let title = '';
            if (notification.type === 'COMMENT') title = currentLanguage === 'ko' ? 'ìƒˆ ëŒ“ê¸€' : 'New Comment';
            else if (notification.type === 'REPLY') title = currentLanguage === 'ko' ? 'ìƒˆ ëŒ€ëŒ“ê¸€' : 'New Reply';
            else if (notification.type === 'LIKE') title = currentLanguage === 'ko' ? 'ìƒˆ ì¢‹ì•„ìš”' : 'New Like';
            else if (notification.type === 'FRIEND_REQUEST') title = currentLanguage === 'ko' ? 'ì¹œêµ¬ ìš”ì²­' : 'Friend Request';
            else if (notification.type === 'FRIEND_ACCEPT') title = currentLanguage === 'ko' ? 'ì¹œêµ¬ ìˆ˜ë½' : 'Friend Accepted';
            else if (notification.type === 'FRIEND_REJECT') title = currentLanguage === 'ko' ? 'ì¹œêµ¬ ê±°ì ˆ' : 'Friend Rejected';

            let message = '';
            if (notification.type === 'COMMENT') {
                message = `${notification.data.categoryTitle ? '[' + notification.data.categoryTitle + '] ' : ''}${notification.data.senderEmail}: ${notification.data.comment}`;
            } else if (notification.type === 'REPLY') {
                const myCommentPreview = (notification.data.myComment || '').substring(0, 20) + '...';
                message = `${notification.data.categoryTitle ? '[' + notification.data.categoryTitle + '] ' : ''}${notification.data.senderEmail}${currentLanguage === 'ko' ? 'ë‹˜ì´ ë‹µê¸€ì„ ë‚¨ê²¼ìŠµë‹ˆë‹¤' : ' replied'}: "${myCommentPreview}" â†’ ${notification.data.comment}`;
            } else if (notification.type === 'LIKE') {
                message = `${notification.data.categoryTitle ? '[' + notification.data.categoryTitle + '] ' : ''}${notification.data.senderEmail}${currentLanguage === 'ko' ? 'ë‹˜ì´ ì¢‹ì•„ìš”ë¥¼ ëˆŒë €ìŠµë‹ˆë‹¤' : ' liked your category'}`;
            } else if (notification.type === 'FRIEND_REQUEST') {
                const requesterEmail = notification.data.requesterEmail || notification.senderEmail || '';
                message = currentLanguage === 'ko' ? `${requesterEmail}ë‹˜ì´ ì¹œêµ¬ ìš”ì²­ì„ ë³´ëƒˆìŠµë‹ˆë‹¤` : `${requesterEmail} sent you a friend request`;
            } else if (notification.type === 'FRIEND_ACCEPT') {
                const senderName = notification.data.senderName || notification.data.senderEmail || '';
                message = currentLanguage === 'ko' ? `${senderName}ë‹˜ì´ ì¹œêµ¬ ìš”ì²­ì„ ìˆ˜ë½í–ˆìŠµë‹ˆë‹¤` : `${senderName} accepted your friend request`;
            } else if (notification.type === 'FRIEND_REJECT') {
                const senderName = notification.data.senderName || notification.data.senderEmail || '';
                message = currentLanguage === 'ko' ? `${senderName}ë‹˜ì´ ì¹œêµ¬ ìš”ì²­ì„ ê±°ì ˆí–ˆìŠµë‹ˆë‹¤` : `${senderName} rejected your friend request`;
            }

            const time = new Date(notification.createdAt).toLocaleTimeString(currentLanguage === 'ko' ? 'ko-KR' : 'en-US', {
                hour: '2-digit',
                minute: '2-digit'
            });

            toast.innerHTML = `
<div class="toast-title">${title}</div>
<div class="toast-message">${message}</div>
<div class="toast-time">${time}</div>
`;

            toast.onclick = () => {
                toggleNotificationModal();
                toast.remove();
            };

            container.appendChild(toast);

            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(400px)';
                setTimeout(() => toast.remove(), 300);
            }, 5000);
        }

        // ì•Œë¦¼ ëª¨ë‹¬ í† ê¸€
        function toggleNotificationModal() {
            const modal = document.getElementById('notificationModal');
            modal.classList.toggle('active');

            if (modal.classList.contains('active')) {
                renderNotificationList();
            }
        }

        // ì•Œë¦¼ ëª©ë¡ ë Œë”ë§
        function renderNotificationList() {
            const listContainer = document.getElementById('notificationList');

            if (notifications.length === 0) {
                const emptyText = currentLanguage === 'ko' ? 'ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤' : 'No notifications';
                listContainer.innerHTML = `<div class="notification-empty">${emptyText}</div>`;
                return;
            }

            let html = '';
            notifications.forEach((notif, index) => {
                let typeText = '';
                if (notif.type === 'COMMENT') typeText = currentLanguage === 'ko' ? 'ëŒ“ê¸€' : 'Comment';
                else if (notif.type === 'REPLY') typeText = currentLanguage === 'ko' ? 'ëŒ€ëŒ“ê¸€' : 'Reply';
                else if (notif.type === 'LIKE') typeText = currentLanguage === 'ko' ? 'ì¢‹ì•„ìš”' : 'Like';
                else if (notif.type === 'FRIEND_REQUEST') typeText = currentLanguage === 'ko' ? 'ì¹œêµ¬ ìš”ì²­' : 'Friend Request';
                else if (notif.type === 'FRIEND_ACCEPT') typeText = currentLanguage === 'ko' ? 'ìˆ˜ë½ë¨' : 'Accepted';
                else if (notif.type === 'FRIEND_REJECT') typeText = currentLanguage === 'ko' ? 'ê±°ì ˆë¨' : 'Rejected';

                let content = '';
                if (notif.type === 'COMMENT') {
                    content = `<span class="notification-item-sender">${notif.data.senderEmail}</span>: ${notif.data.comment}`;
                } else if (notif.type === 'REPLY') {
                    const myCommentPreview = (notif.data.myComment || '').substring(0, 30) + '...';
                    content = `<span class="notification-item-sender">${notif.data.senderEmail}</span>${currentLanguage === 'ko' ? 'ë‹˜ì´ ë‹µê¸€ì„ ë‚¨ê²¼ìŠµë‹ˆë‹¤' : ' replied to'}: "${myCommentPreview}" â†’ ${notif.data.comment}`;
                } else if (notif.type === 'LIKE') {
                    content = `<span class="notification-item-sender">${notif.data.senderEmail}</span>${currentLanguage === 'ko' ? 'ë‹˜ì´ ì¢‹ì•„ìš”ë¥¼ ëˆŒë €ìŠµë‹ˆë‹¤' : ' liked your category'}`;
                } else if (notif.type === 'FRIEND_REQUEST') {
                    const requesterEmail = notif.data.requesterEmail || notif.senderEmail || '';
                    content = `<span class="notification-item-sender">${requesterEmail}</span>${currentLanguage === 'ko' ? 'ë‹˜ì´ ì¹œêµ¬ ìš”ì²­ì„ ë³´ëƒˆìŠµë‹ˆë‹¤' : ' sent you a friend request'}`;
                } else if (notif.type === 'FRIEND_ACCEPT') {
                    const senderName = notif.data.senderName || notif.data.senderEmail || '';
                    content = `<span class="notification-item-sender">${senderName}</span>${currentLanguage === 'ko' ? 'ë‹˜ì´ ì¹œêµ¬ ìš”ì²­ì„ ìˆ˜ë½í–ˆìŠµë‹ˆë‹¤' : ' accepted your friend request'}`;
                } else if (notif.type === 'FRIEND_REJECT') {
                    const senderName = notif.data.senderName || notif.data.senderEmail || '';
                    content = `<span class="notification-item-sender">${senderName}</span>${currentLanguage === 'ko' ? 'ë‹˜ì´ ì¹œêµ¬ ìš”ì²­ì„ ê±°ì ˆí–ˆìŠµë‹ˆë‹¤' : ' rejected your friend request'}`;
                }

                const time = getRelativeTime(new Date(notif.createdAt));

                html += `
    <div class="notification-item ${index < unreadCount ? 'unread' : ''}">
        <div class="notification-item-header">
            <span class="notification-item-type ${notif.type.toLowerCase()}">${typeText}</span>
            <span class="notification-item-time">${time}</span>
        </div>
        <div class="notification-item-content">${content}</div>
    </div>
`;
            });

            listContainer.innerHTML = html;
        }

        // ìƒëŒ€ ì‹œê°„ ê³„ì‚°
        function getRelativeTime(date) {
            const now = new Date();
            const diff = Math.floor((now - date) / 1000);

            if (diff < 60) return currentLanguage === 'ko' ? 'ë°©ê¸ˆ ì „' : 'Just now';
            if (diff < 3600) return `${Math.floor(diff / 60)}${currentLanguage === 'ko' ? 'ë¶„ ì „' : 'm ago'}`;
            if (diff < 86400) return `${Math.floor(diff / 3600)}${currentLanguage === 'ko' ? 'ì‹œê°„ ì „' : 'h ago'}`;
            return `${Math.floor(diff / 86400)}${currentLanguage === 'ko' ? 'ì¼ ì „' : 'd ago'}`;
        }

        // ëª¨ë‘ ì½ìŒ ì²˜ë¦¬
        async function markAllAsRead() {
            if (notifications.length === 0) return;

            const unreadIds = notifications.slice(0, unreadCount).map(n => n.id).filter(id => id);

            if (unreadIds.length === 0) return;

            try {
                const response = await apiCall('/notification/unread', {
                    method: 'POST',
                    body: JSON.stringify({ notificationIds: unreadIds })
                });

                if (response.ok) {
                    unreadCount = 0;
                    updateNotificationBadge();
                    renderNotificationList();
                }
            } catch (error) {
                console.error('ì½ìŒ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
            }
        }

        // ì½ì§€ ì•Šì€ ì•Œë¦¼ ë¡œë“œ
        async function loadUnreadNotifications() {
            console.log('>>> loadUnreadNotifications ì‹œì‘');
            try {
                const response = await apiCall('/notification/unread');

                if (response.ok) {
                    const unreadNotifications = await response.json();
                    notifications = unreadNotifications || [];
                    unreadCount = notifications.length;
                    console.log('ì½ì§€ ì•Šì€ ì•Œë¦¼ ë¡œë“œ:', notifications.length, 'ê°œ');
                    console.log('ì•Œë¦¼ ë°ì´í„°:', notifications);
                    updateNotificationBadge();

                    // ëª¨ë‹¬ì´ ì—´ë ¤ìˆìœ¼ë©´ ì¦‰ì‹œ ë Œë”ë§
                    const modal = document.getElementById('notificationModal');
                    if (modal && modal.classList.contains('active')) {
                        renderNotificationList();
                    }
                }
            } catch (error) {
                console.error('ì•Œë¦¼ ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('notificationModal').addEventListener('click', (e) => {
            if (e.target.id === 'notificationModal') {
                toggleNotificationModal();
            }
        });
    </script>
    <!-- í† ìŠ¤íŠ¸ ì•Œë¦¼ ì»¨í…Œì´ë„ˆ -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- ì•Œë¦¼ ëª¨ë‹¬ -->
    <div class="notification-modal" id="notificationModal">
        <div class="notification-modal-content">
            <div class="notification-modal-header">
                <div class="notification-modal-title" data-lang-ko="ì•Œë¦¼" data-lang-en="Notifications">ì•Œë¦¼</div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <button class="mark-all-read-btn" onclick="markAllAsRead()" data-lang-ko="ëª¨ë‘ ì½ìŒ" data-lang-en="Mark all read">ëª¨ë‘ ì½ìŒ</button>
                    <button class="notification-modal-close" onclick="toggleNotificationModal()">Ã—</button>
                </div>
            </div>
            <div class="notification-list" id="notificationList">
                <div class="notification-empty" data-lang-ko="ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤" data-lang-en="No notifications">ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤</div>
            </div>
        </div>
    </div>

</div><!-- mainSection ë -->

</body>
</html>